{% extends "allauth/base.html" %} {% load static %} {% load i18n %} {% load account socialaccount %} {% block header %} <div id=logo-group > <span id=logo > <img src="{% static 'smart-admin-2/img/logo.png' %}" alt=SmartAdmin > </span> </div> <span id=extr-page-header-space > <span class="hidden-mobile hiddex-xs">Need an account?</span> {% get_current_language as LANGUAGE_CODE %} <a href="{% url 'account_signup' %}" class="btn btn-danger">Create {{ translated_url }}</a> </span> {% endblock %} {% block content %} <div id=content  class=container > <div class=row > <div class="col-xs-12 col-sm-12 col-md-7 col-lg-8 hidden-xs hidden-sm"> {% include "allauth/snippets/login_info.html" %} <div class=row > </div> </div> <div class="col-xs-12 col-sm-12 col-md-5 col-lg-4"> <div class="provider text-center"> <div id=show_curr_site > Show : <a id=curr_site  target=_blank ></a> <hr> </div> {% get_providers as socialaccount_providers %} {% if socialaccount_providers %} <h5 class=text-center > - {% trans "Sign in using" %} -</h5> <ul class="list-inline text-center"> {% include "socialaccount/snippets/provider_list.html" with process="login" %} </ul> <h5 class=text-center > - {% trans "or" %} -</h5> {% endif %} </div> <div class="well no-padding"> <form method=POST  id=login-form  class="smart-form client-form"> {% csrf_token %} <header> {% trans "Sign In" %} </header> <fieldset> {% if form.errors %} {% for field in form %} {% for error in field.errors %} <div class="alert alert-danger"> <strong>{{ error|escape }}</strong> </div> {% endfor %} {% endfor %} {% for error in form.non_field_errors %} <div class="alert alert-danger"> <strong>{{ error|escape }}</strong> </div> {% endfor %} {% endif %} <section> <label class=label >{{form.login.label}}</label> <label class=input > <i class="icon-append fa fa-user"></i> {{form.login}} <b class="tooltip tooltip-top-right"><i class="fa fa-user txt-color-teal"></i> {% trans "Please enter email address" %}</b></label> </section> <section> <label class=label >{{form.password.label}}</label> <label class=input > <i class="icon-append fa fa-lock"></i> {{form.password}} <b class="tooltip tooltip-top-right"><i class="fa fa-lock txt-color-teal"></i> {% trans "Enter your password" %}</b> </label> <div class=note > <a href="{% url 'account_reset_password' %}">{% trans "Forgot password" %}?</a> </div> <input type=hidden  name=next  value="/post-login/" /> </section> <section> <label class=checkbox > <input type=checkbox  name=remember  checked=""> <i></i>{% trans "Stay signed in" %}</label> </section> <section> {{form.captcha}} </section> </fieldset> <footer> <button id=btn-sign-in  type=submit  class="btn btn-primary"> {% trans "Sign in" %} </button> </footer> </form> </div> </div> </div> </div> {% endblock %} {% block extra_body %} <script> $(function() { var curr_site = $('#curr_site'); var retrievedObject = localStorage.getItem('curr_site'); if (retrievedObject) { var tmp = JSON.parse(retrievedObject); curr_site.attr('href', tmp.href); curr_site.text(tmp.text); $('#show_curr_site').show(); } else { $('#show_curr_site').hide(); } let main_domain = "{{main_domain}}"; console.log('maindomain', main_domain); let baseurl = window.location.host.toString(); console.log('baseurl', window.location.host); console.log('origin', window.location.origin.toString()); let url = window.location.origin.toString(); console.log('url',url); let rep = url.replace(window.location.host, main_domain); console.log('replace', rep); if (!((baseurl.indexOf('localhost') >= 0) || (baseurl.indexOf('127.0.0.1') >= 0))) { if (main_domain !== baseurl) window.location.href = rep + "/" + "dashboard"; }; const queryString = window.location.search; const urlParams = new URLSearchParams(queryString); let site_id = "{{site_id}}"; const session_key = urlParams.get('s'); const user_id = urlParams.get('u'); const social_media = urlParams.get('media'); $("#btn-sign-in").click(function() { window.history.pushState(null, null, window.location.pathname); localStorage.removeItem('session_key'); }); }); </script> {% endblock %}