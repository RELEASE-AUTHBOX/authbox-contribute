{% extends "allauth/base.html" %} {% load static %} {% load i18n %} {% load account socialaccount %} {% block header %} <div id=logo-group > <span id=logo > <img src="{% static 'smart-admin-2/img/logo.png' %}" alt=SmartAdmin > </span> </div> <span id=extr-page-header-space > <span class="hidden-mobile hiddex-xs">Back to Login Page</span> <a href="{% url 'account_login' %}" class="btn btn-danger">Login</a> </span> {% endblock %} {% block content %} <div id=content class=container > <div class=row > <div class="col-xs-12 col-sm-12 col-md-7 col-lg-8 hidden-xs hidden-sm"> {% include "allauth/snippets/login_info.html" %} <div class=row > </div> </div> <div class="col-xs-12 col-sm-12 col-md-5 col-lg-4"> <div class="well no-padding"> <form method=POST id=init-form class="smart-form client-form"> {% csrf_token %} <header> {% trans "Inisialisasi Data" %} </header> <fieldset> {% if error %} <p style="color: crimson ;">{{error}} </p> <br> <p> Kembali ke Pengaturan Sebelumnya? <span class=pull-right > <a href="{% url 'user_reset_agency' %}">Reset</a> </span> </p> <br> {% endif %} <section> <label class=label >Login Sebagai : &nbsp;<strong>{{ user.name|default:user.email|lower }} </strong> <div class=pull-right > <a href="{% url 'account_logout' %}">Logout</a> </div> </label> </section> <hr><br> {% if service %} <section> <label class=label >Pilih Nama Service:</label> {% for i in service %} <p> <a href="javascript:void(0)" onclick="on_click_service('/dashboard/user/initialize/service-ajax/{{agency_id}}/{{i.id}}')">{{i.get_kind_display}} :</a> {{i.site.domain}} </p> {% endfor %} </section> {% else %} <section> <label class=label >Jenis Service</label> <label class=select > <select id=select_service name=select_service > <option value=0 >--pilih salah satu-- {% for i, j in service_opt %} <option value="{{i}}">{{j}} {% endfor %} </select> <i></i> </label> </section> {% endif %} </fieldset> <footer> <button id=btn-sign-in type=submit class="btn btn-primary"> {% trans "Submit" %} </button> </footer> </form> </div> </div> </div> </div> {% endblock %} {% block extra_body %} <script> function on_click_service(param) { $.ajax({ url: param, success: function(result) { console.log(result); window.location.href = '/dashboard/'; } }); }; $(function() { $("#btn-sign-in").click(function() { window.history.pushState(null, null, window.location.pathname); localStorage.removeItem('session_key'); }); $('.select2_template').select2({placeholder: "--Pilih salah satu--"}); $('#select_service').on('change', function (e) { var optionSelected = $("option:selected", this); var valueSelected = this.value; console.log('res', optionSelected, valueSelected); $('.select2_template').val('0'); $('.select2_template').trigger('change'); $('.select2_template').select2({ ajax: { url: "/dashboard/service-change-ajax/" + valueSelected, delay: 250, dataType: 'json', data: function (params) { var query = { search: params.term, page: params.page || 1 }; return query; }, processResults: function (data, params) { params.page = params.page || 1; return { results: data.results, pagination: { more: (params.page * 10) < data.count_filtered } }; }, }, placeholder: "--Pilih salah satu--", allowClear: false, }); }); $('form').submit(function () { var select_service = $('#select_service').find(":selected").val(); var mfind = false; if (select_service==0) { alert('Jenis Service belum dipilih.'); mfind = true; } return (!mfind); }); }); </script> {% endblock %}