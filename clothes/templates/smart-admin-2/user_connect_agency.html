{% extends "allauth/base.html" %} {% load static %} {% load i18n %} {% load account socialaccount %} {% block header %} <div id=logo-group > <span id=logo > <img src="{% static 'smart-admin-2/img/logo.png' %}" alt=SmartAdmin > </span> </div> <span id=extr-page-header-space > <span class="hidden-mobile hiddex-xs">Back to Login Page</span> <a href="{% url 'account_login' %}" class="btn btn-danger">Login</a> </span> {% endblock %} {% block content %} <div id=content class=container > <div class=row > <div class="col-xs-12 col-sm-12 col-md-7 col-lg-8 hidden-xs hidden-sm"> {% include "allauth/snippets/login_info.html" %} <div class=row > </div> </div> <div class="col-xs-12 col-sm-12 col-md-5 col-lg-4"> <div class="well no-padding"> <form method=POST id=init-form class="smart-form client-form"> {% csrf_token %} <header> {% trans "Connect to Agency" %} </header> <fieldset> {% if error %} <p style="color: crimson ;">{{error}} </p> <p> Kembali ke halaman sebelumnya <span class=pull-right > <a href="{% url 'user_init_agency' %}">Kembali</a> </span> </p> <br> {% endif %} <section> <label class=label >Login Sebagai : &nbsp;<strong>{{ user.name|default:user.email|lower }} </strong> <div class=pull-right > <a href="{% url 'account_logout' %}">Logout</a> </div> </label> </section> <hr><br> <section> <label class=label >Masukkan Kode Instansi / Perusahaan</label> <label class=input > <input id=agent-code name=agent-code type=text list=list > <datalist id=list > {% for i in agency %} <option value="{{i.name}}">{{i.name}} {% endfor %} </datalist> </label> </section> </fieldset> <footer> <button id=btn-sign-in type=submit class="btn btn-primary"> {% trans "Submit" %} </button> </footer> </form> </div> </div> </div> </div> {% endblock %} {% block extra_body %} <script> function on_click_service(param) { $.ajax({ url: param, success: function(result) { if (result['result']) window.location.href = param.replace('agency-ajax','service'); } }); }; $(function() { $("#btn-sign-in").click(function() { window.history.pushState(null, null, window.location.pathname); localStorage.removeItem('session_key'); }); {% comment %} {% if request.user.is_authenticated %} console.log('is auth'); {% else %} console.log('is not auth'); $.ajax({ url: "/post-login/force-authenticate/4/", success: function(result) { console.log('force authenticate:',result); } }); {% endif %} {% endcomment %} $('.select2_template').select2({placeholder: "--Pilih salah satu--"}); $('#select_service').on('change', function (e) { var optionSelected = $("option:selected", this); var valueSelected = this.value; console.log('res', optionSelected, valueSelected); $('.select2_template').val('0'); $('.select2_template').trigger('change'); $('.select2_template').select2({ ajax: { url: "/dashboard/service-change-ajax/" + valueSelected, delay: 250, dataType: 'json', data: function (params) { var query = { search: params.term, page: params.page || 1 }; return query; }, processResults: function (data, params) { params.page = params.page || 1; return { results: data.results, pagination: { more: (params.page * 10) < data.count_filtered } }; }, }, placeholder: "--Pilih salah satu--", allowClear: false, }); }); $('form').submit(function () { var name = $.trim($('#agent-code').val()); var mfind = false; if (name === '') { alert('Kode Instansi masih kosong.'); mfind = true; } return (!mfind); }); }); </script> {% endblock %}