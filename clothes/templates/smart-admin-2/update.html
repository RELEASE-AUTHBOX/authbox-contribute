{% extends "smart-admin-2/base-crud.html" %} {% load static %} {% load menu_tags %} {% load crispy_forms_tags %} {% load i18n %} {% block breadcrumb %} <div id=ribbon > <span class=ribbon-button-alignment > <span id=refresh  class="btn btn-ribbon" data-action=resetWidgets  data-title=refresh  rel=tooltip  data-placement=bottom  data-original-title="<i class='text-warning fa fa-warning'></i> Warning! This will reset all your widget settings." data-html="true"> <i class="fa fa-refresh"></i> </span> </span> <ol class=breadcrumb > <li>Dashboard {% for i in my_active %} <li>{{i}} {% endfor %} <li>Update Data </ol> </div> {% endblock %} {% block content %} <div id=content > <form method=post  enctype = "multipart/form-data"> {% csrf_token %} <div class=row > <div class="col-xs-12 col-sm-7 col-md-7 col-lg-4"> <h1 class="page-title txt-color-blueDark"> {% for i in my_menu %} {% if i.name in my_active|slice:"1:" %} <i class="fa-fw fa {{ i.icon }}"></i> {% endif %} {% endfor %} {% for i in my_active %} {% if forloop.last %} {{ i }} {% endif %} {% endfor %} <span>> Update Data </span> </h1> </div> <div class="col-xs-12 col-sm-5 col-md-5 col-lg-8"> <ul id=sparks > <li class=sparks-info > {% get_current_language as CURRENT_LANGUAGE %} {% get_available_languages as AVAILABLE_LANGUAGES %} {% get_language_info_list for AVAILABLE_LANGUAGES as languages %} <div class=col > <select name=language  class="form-control custom-scroll" title="Klik untuk memilih bahasa"> {% for language in languages %} {% if language.code == CURRENT_LANGUAGE %} <option value="{{ language.code }}" selected=selected >{{ language.name_local }} {% else %} <option value="{{ language.code }}">{{ language.name_local }} {% endif %} {% endfor %} </select> </div> <li class=sparks-info > <button type=submit  class="btn btn-primary" title=Simpan >Simpan</button> <button id=do_cancel  class="btn btn-danger" type=button  name=button  title=Batal ><i class="fa fa-times"></i> Batal</button> </ul> </div> </div> <section id=widget-grid  class=""> <div class=row > <article class="col-xs-12 col-sm-12 col-md-12 col-lg-12"> <div class="jarviswidget jarviswidget-color-blueDark" id=wid-id-0  data-widget-colorbutton=false  data-widget-editbutton=false  data-widget-custombutton=false > <header> <span class=widget-icon > <i class="fa fa-pencil"></i> </span> <h2>Update Data </h2> </header> <div> <div class=jarviswidget-editbox > <input class=form-control  type=text > </div> <div class=widget-body > {% if select2 %} <div class=form-group > <label for=id_select2_menu  class=" requiredField" style="width: 100%; "> {{select2}} <select id=id_select2_menu  name=select2_menu  class="form-control select2_menu" style="width: 100%; "> </select> </label> </div> {% endif %} {{ form.media }} {{ form|crispy }} {% if select2_global_setting %} <div class=form-group > <label for=id_select2_global_setting  class=" requiredField" style="width: 100%; "> {{select2_global_setting}} <select id=id_select2_global_setting  name=select2_global_setting  class="form-control select2_global_setting" style="width: 100%; "> </select> </label> </div> {% endif %} {% if photo %} {{ photo|crispy }} {% endif %} {% comment %} {% if post_photo %} {% for i in post_photo %} <img src="{{i}}" class=img-thumbnail > {% endfor %} {% endif %} {% endcomment %} <hr class=simple > <div class=text-right > <button type=submit  class="btn btn-primary" title=Simpan >Simpan</button> <button id=do_cancel2  class="btn btn-danger" type=button  name=button  title=Batal ><i class="fa fa-times"></i> Batal</button> </div> </div> </div> </div> </article> </div> <div class=row > <div class=col-sm-12 > </div> </div> </section> </form> </div> {% endblock %} {% block extra_body %} <script> function do_refresh_dim() { let position = $('#id_position').val() ? $('#id_position').val() : 0; console.log('position', position); $.ajax({ url: "/get-crop-image-size/{{active_page}}/" + position + "/", success: function(result){ console.log('before' + $("#id_dim_w").val() + ' x ' + $("#id_dim_h").val()); console.log('width height image = ' + result.ww + ' ' + result.hh); if (!(result.ww==0 || result.hh==0)) { $("#id_dim_w").val(result.ww); $("#id_dim_h").val(result.hh); }; console.log('after' + $("#id_dim_w").val() + ' x ' + $("#id_dim_h").val()); } }); }; $(document).ready(function() { $('#id_setting_name').prop('disabled', true); $('#id_setting_name').val($('#id_name option:selected').text()); if ('{{active_page}}' == 'menu_dashboard') $("#id_name").prop('disabled', true); const selectElement = document.getElementById("id_position"); if (selectElement) { selectElement.addEventListener("change", function () { do_refresh_dim(); }); }; do_refresh_dim(); do_cancel("#do_cancel", "Update Data", "{% url active_page_url %}"); do_cancel("#do_cancel2", "Update Data", "{% url active_page_url %}"); var template_id = ''; var template_block_model_list_id = ''; {% if template_id %} template_id = {{template_id}}; {% endif %} {% if template_block_model_list_id %} template_block_model_list_id = {{template_block_model_list_id}}; {% endif %} $('.select2_global_setting').select2({ ajax: { url: '/dashboard/application-update-ajax?t='+ template_id +'&ml='+ template_block_model_list_id, delay: 250, dataType: 'json', data: function (params) { var query = { search: params.term, page: params.page || 1 }; return query; }, processResults: function (data, params) { params.page = params.page || 1; return { results: data.results, pagination: { more: (params.page * 10) < data.count_filtered } }; }, }, theme: 'bootstrap4', placeholder: "[Pilih]", allowClear: false, }); $('.select2_menu').select2({ ajax: { url: '/dashboard/menu-lookup-ajax/', delay: 250, dataType: 'json', data: function (params) { var query = { search: params.term, page: params.page || 1 }; return query; }, processResults: function (data, params) { params.page = params.page || 1; return { results: data.results, pagination: { more: (params.page * 10) < data.count_filtered } }; }, }, theme: 'bootstrap4', placeholder: "ROOT", allowClear: false, }); {% if select2_update %} var select2_update = {{select2_update|safe}}; $(".select2_menu").select2("trigger", "select", { data : select2_update }); {% endif %} {% if select2_update_global_setting %} var select2_update_global_setting = {{select2_update_global_setting|safe}}; console.log('select2_update_global_setting', select2_update_global_setting); $(".select2_global_setting").select2("trigger", "select", { data : select2_update_global_setting }); {% endif %} $('.select2_global_setting').on('select2:open', () => { this.querySelector('.select2-search__field').focus(); }); $('.select2_global_setting').on('select2:select', function (e) { var data = e.params.data; }); }); </script> {% endblock %}